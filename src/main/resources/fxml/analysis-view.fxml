<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.*?>
<?import javafx.geometry.Insets?>

<BorderPane xmlns="http://javafx.com/javafx/11.0.1" xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.lucidia.lucidia.controller.AnalysisController"
            prefHeight="800" prefWidth="1400" styleClass="main-container">

    <top>
        <VBox spacing="15" prefHeight="160" maxHeight="160">
            <padding>
                <Insets bottom="20" left="30" right="30" top="25" />
            </padding>

            <!-- Cosmic Header with Gradient Background -->
            <HBox alignment="CENTER" spacing="20" prefHeight="60"
                  style="-fx-background-color: linear-gradient(to right, rgba(138,43,226,0.2), rgba(75,0,130,0.2)); -fx-background-radius: 15; -fx-padding: 15;">
                <Label style="-fx-font-size: 32px; -fx-font-weight: bold; -fx-text-fill: linear-gradient(to right, #DDA0DD, #DA70D6);" text="ðŸ”® Dream Oracle Analysis" />
                <Region HBox.hgrow="ALWAYS" />
                <VBox alignment="CENTER_RIGHT" spacing="3">
                    <Label fx:id="analysisDateLabel" text="âœ¨ Analyzed today" style="-fx-font-style: italic; -fx-font-size: 14px; -fx-text-fill: #DDA0DD;" />
                    <Label text="Your subconscious decoded" style="-fx-font-size: 11px; -fx-text-fill: #9370DB; -fx-font-style: italic;" />
                </VBox>
            </HBox>

            <Separator prefHeight="3" style="-fx-background-color: linear-gradient(to right, transparent, #8A2BE2, #DDA0DD, #8A2BE2, transparent);" />

            <!-- Enhanced Quick Insights Cards -->
            <HBox spacing="20" alignment="CENTER" prefHeight="75" maxHeight="75">
                <!-- Dominant Emotion Card -->
                <VBox spacing="6" alignment="CENTER" prefWidth="200" prefHeight="75" styleClass="card"
                      style="-fx-background-color: linear-gradient(135deg, rgba(138,43,226,0.25), rgba(147,112,219,0.25)); -fx-background-radius: 15; -fx-border-color: #8A2BE2; -fx-border-width: 2; -fx-border-radius: 15; -fx-effect: dropshadow(gaussian, rgba(138,43,226,0.4), 15, 0.4, 0, 3);">
                    <Label text="ðŸŽ­ Dominant Emotion" style="-fx-font-weight: 600; -fx-font-size: 10px; -fx-text-fill: #DDA0DD;" />
                    <Label fx:id="dominantEmotionLabel" text="Joy" style="-fx-font-size: 18px; -fx-font-weight: bold; -fx-text-fill: #F0F8FF;" />
                    <Label text="Primary feeling detected" style="-fx-font-size: 8px; -fx-text-fill: #9370DB; -fx-font-style: italic;" />
                </VBox>

                <!-- Confidence Card -->
                <VBox spacing="6" alignment="CENTER" prefWidth="200" prefHeight="75" styleClass="card"
                      style="-fx-background-color: linear-gradient(135deg, rgba(147,112,219,0.25), rgba(221,160,221,0.25)); -fx-background-radius: 15; -fx-border-color: #9370DB; -fx-border-width: 2; -fx-border-radius: 15; -fx-effect: dropshadow(gaussian, rgba(147,112,219,0.4), 15, 0.4, 0, 3);">
                    <Label text="ðŸŽ¯ Analysis Confidence" style="-fx-font-weight: 600; -fx-font-size: 10px; -fx-text-fill: #DDA0DD;" />
                    <Label fx:id="confidenceScoreLabel" text="92%" style="-fx-font-size: 18px; -fx-font-weight: bold; -fx-text-fill: #F0F8FF;" />
                    <Label text="AI certainty level" style="-fx-font-size: 8px; -fx-text-fill: #9370DB; -fx-font-style: italic;" />
                </VBox>

                <!-- Symbols Found Card -->
                <VBox spacing="6" alignment="CENTER" prefWidth="200" prefHeight="75" styleClass="card"
                      style="-fx-background-color: linear-gradient(135deg, rgba(221,160,221,0.25), rgba(218,112,214,0.25)); -fx-background-radius: 15; -fx-border-color: #DDA0DD; -fx-border-width: 2; -fx-border-radius: 15; -fx-effect: dropshadow(gaussian, rgba(221,160,221,0.4), 15, 0.4, 0, 3);">
                    <Label text="ðŸ”® Symbolic Elements" style="-fx-font-weight: 600; -fx-font-size: 10px; -fx-text-fill: #DDA0DD;" />
                    <Label fx:id="symbolCountLabel" text="7 symbols" style="-fx-font-size: 18px; -fx-font-weight: bold; -fx-text-fill: #F0F8FF;" />
                    <Label text="Universal archetypes" style="-fx-font-size: 8px; -fx-text-fill: #9370DB; -fx-font-style: italic;" />
                </VBox>

                <!-- Dream Intensity Card -->
                <VBox spacing="6" alignment="CENTER" prefWidth="200" prefHeight="75" styleClass="card"
                      style="-fx-background-color: linear-gradient(135deg, rgba(218,112,214,0.25), rgba(255,105,180,0.25)); -fx-background-radius: 15; -fx-border-color: #DA70D6; -fx-border-width: 2; -fx-border-radius: 15; -fx-effect: dropshadow(gaussian, rgba(218,112,214,0.4), 15, 0.4, 0, 3);">
                    <Label text="âš¡ Dream Intensity" style="-fx-font-weight: 600; -fx-font-size: 10px; -fx-text-fill: #DDA0DD;" />
                    <Label fx:id="intensityLabel" text="High" style="-fx-font-size: 18px; -fx-font-weight: bold; -fx-text-fill: #F0F8FF;" />
                    <Label text="Emotional magnitude" style="-fx-font-size: 8px; -fx-text-fill: #9370DB; -fx-font-style: italic;" />
                </VBox>
            </HBox>
        </VBox>
    </top>

    <center>
        <HBox spacing="25" prefHeight="550" maxHeight="550">
            <padding>
                <Insets bottom="20" left="30" right="30" top="15" />
            </padding>

            <!-- Left Column - Main Analysis -->
            <VBox spacing="20" HBox.hgrow="ALWAYS" prefWidth="750">

                <!-- Dream Interpretation Card - NO SCROLL -->
                <VBox spacing="12" prefHeight="260" maxHeight="260" styleClass="analysis-card"
                      style="-fx-background-color: linear-gradient(145deg, rgba(25,25,112,0.4), rgba(30,30,60,0.5)); -fx-background-radius: 20; -fx-border-color: #8A2BE2; -fx-border-width: 2; -fx-border-radius: 20; -fx-padding: 25; -fx-effect: dropshadow(gaussian, rgba(138,43,226,0.5), 20, 0.4, 0, 4);">
                    <HBox alignment="CENTER_LEFT" spacing="10" prefHeight="30">
                        <Label text="ðŸ§  Dream Interpretation" style="-fx-font-size: 18px; -fx-font-weight: bold; -fx-text-fill: #F0F8FF;" />
                        <Region HBox.hgrow="ALWAYS" />
                        <Label text="Deep Analysis" style="-fx-font-size: 10px; -fx-text-fill: #9370DB; -fx-font-style: italic; -fx-background-color: rgba(147,112,219,0.3); -fx-padding: 4 8; -fx-background-radius: 8;" />
                    </HBox>
                    <Separator style="-fx-background-color: linear-gradient(to right, #8A2BE2, #DDA0DD); -fx-pref-height: 2;" />
                    <TextFlow fx:id="interpretationFlow" prefHeight="180" maxHeight="180" style="-fx-padding: 10; -fx-line-spacing: 3px;" />
                </VBox>

                <!-- Emotional Landscape Card - NO SCROLL -->
                <VBox spacing="15" prefHeight="250" maxHeight="250" styleClass="analysis-card"
                      style="-fx-background-color: linear-gradient(145deg, rgba(75,0,130,0.4), rgba(35,35,70,0.5)); -fx-background-radius: 20; -fx-border-color: #9370DB; -fx-border-width: 2; -fx-border-radius: 20; -fx-padding: 25; -fx-effect: dropshadow(gaussian, rgba(147,112,219,0.5), 20, 0.4, 0, 4);">
                    <HBox alignment="CENTER_LEFT" spacing="10" prefHeight="30">
                        <Label text="ðŸ’« Emotional Landscape" style="-fx-font-size: 18px; -fx-font-weight: bold; -fx-text-fill: #F0F8FF;" />
                        <Region HBox.hgrow="ALWAYS" />
                        <Label text="Sentiment Map" style="-fx-font-size: 10px; -fx-text-fill: #9370DB; -fx-font-style: italic; -fx-background-color: rgba(147,112,219,0.3); -fx-padding: 4 8; -fx-background-radius: 8;" />
                    </HBox>
                    <Separator style="-fx-background-color: linear-gradient(to right, #9370DB, #DDA0DD); -fx-pref-height: 2;" />
                    <VBox fx:id="emotionBarsContainer" spacing="8" prefHeight="170" maxHeight="170" style="-fx-padding: 10;" />
                </VBox>

            </VBox>

            <!-- Right Column - Symbols & Recommendations -->
            <VBox spacing="20" prefWidth="380" maxWidth="380">

                <!-- Symbolic Elements Card - NO SCROLL -->
                <VBox spacing="12" prefHeight="260" maxHeight="260" styleClass="analysis-card"
                      style="-fx-background-color: linear-gradient(145deg, rgba(138,43,226,0.4), rgba(75,0,130,0.5)); -fx-background-radius: 20; -fx-border-color: #8A2BE2; -fx-border-width: 2; -fx-border-radius: 20; -fx-padding: 25; -fx-effect: dropshadow(gaussian, rgba(138,43,226,0.5), 20, 0.4, 0, 4);">
                    <HBox alignment="CENTER_LEFT" spacing="10" prefHeight="30">
                        <Label text="ðŸ”® Symbolic Elements" style="-fx-font-size: 18px; -fx-font-weight: bold; -fx-text-fill: #F0F8FF;" />
                        <Region HBox.hgrow="ALWAYS" />
                        <Label text="Decoded" style="-fx-font-size: 10px; -fx-text-fill: #9370DB; -fx-font-style: italic; -fx-background-color: rgba(147,112,219,0.3); -fx-padding: 4 8; -fx-background-radius: 8;" />
                    </HBox>
                    <Separator style="-fx-background-color: linear-gradient(to right, #8A2BE2, #DDA0DD); -fx-pref-height: 2;" />
                    <VBox fx:id="symbolDictionaryContainer" spacing="8" prefHeight="180" maxHeight="180" style="-fx-padding: 10;" />
                </VBox>

                <!-- Personal Insights Card - NO SCROLL -->
                <VBox spacing="12" prefHeight="250" maxHeight="250" styleClass="analysis-card"
                      style="-fx-background-color: linear-gradient(145deg, rgba(147,112,219,0.4), rgba(138,43,226,0.5)); -fx-background-radius: 20; -fx-border-color: #DDA0DD; -fx-border-width: 2; -fx-border-radius: 20; -fx-padding: 25; -fx-effect: dropshadow(gaussian, rgba(221,160,221,0.5), 20, 0.4, 0, 4);">
                    <HBox alignment="CENTER_LEFT" spacing="10" prefHeight="30">
                        <Label text="âœ¨ Personal Insights" style="-fx-font-size: 18px; -fx-font-weight: bold; -fx-text-fill: #F0F8FF;" />
                        <Region HBox.hgrow="ALWAYS" />
                        <Label text="For You" style="-fx-font-size: 10px; -fx-text-fill: #9370DB; -fx-font-style: italic; -fx-background-color: rgba(147,112,219,0.3); -fx-padding: 4 8; -fx-background-radius: 8;" />
                    </HBox>
                    <Separator style="-fx-background-color: linear-gradient(to right, #DDA0DD, #DA70D6); -fx-pref-height: 2;" />
                    <TextFlow fx:id="recommendationsFlow" prefHeight="170" maxHeight="170" style="-fx-padding: 10; -fx-line-spacing: 3px;" />
                </VBox>

            </VBox>
        </HBox>
    </center>

    <bottom>
        <VBox spacing="0" prefHeight="90" maxHeight="90">
            <Separator style="-fx-background-color: linear-gradient(to right, transparent, #8A2BE2, #DDA0DD, #8A2BE2, transparent); -fx-pref-height: 3;" />
            <HBox alignment="CENTER" spacing="20" prefHeight="87" maxHeight="87" style="-fx-background-color: linear-gradient(to bottom, rgba(25,25,112,0.3), rgba(16,33,62,0.4)); -fx-padding: 20 30;">
                <HBox spacing="15" alignment="CENTER_LEFT">
                    <Button fx:id="saveAnalysisButton" text="ðŸ’¾ Save Analysis" onAction="#handleSaveAnalysis"
                            style="-fx-font-size: 13px; -fx-padding: 10 20; -fx-font-weight: 600;" prefHeight="35" />
                    <Button fx:id="exportButton" text="ðŸ“„ Export PDF" onAction="#handleExport"
                            style="-fx-font-size: 13px; -fx-padding: 10 20; -fx-font-weight: 600;" prefHeight="35" />
                    <Button fx:id="shareButton" text="ðŸ”— Share Insights" onAction="#handleShare"
                            style="-fx-font-size: 13px; -fx-padding: 10 20; -fx-font-weight: 600;" prefHeight="35" />
                </HBox>

                <Region HBox.hgrow="ALWAYS" />

                <HBox spacing="15" alignment="CENTER_RIGHT">
                    <Button fx:id="newAnalysisButton" text="ðŸ†• New Dream" onAction="#handleNewDream"
                            style="-fx-font-size: 13px; -fx-padding: 10 20; -fx-font-weight: 600; -fx-background-color: linear-gradient(45deg, #4169E1, #8A2BE2);" prefHeight="35" />
                    <Button fx:id="backButton" text="â¬…ï¸ Back to Journal" onAction="#handleBack"
                            style="-fx-font-size: 13px; -fx-padding: 10 20; -fx-font-weight: 600;" prefHeight="35" />
                </HBox>
            </HBox>
        </VBox>
    </bottom>

</BorderPane>
